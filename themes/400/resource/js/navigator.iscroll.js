(function(e,t){e.ui.navigator.register(function(){return{pluginName:"iscroll",_init:function(){return this._adjustHtml()._reBindEvent()._initOrg()},_reBindEvent:function(){var n=this,r=n._data;return r.isScrollToNext=r.isScrollToNext===t?!0:r.isScrollToNext,r.isShowShadow=r.isShowShadow===t?!0:r.isShowShadow,n._loadIscroll(),e(window).on("ortchange",e.proxy(n._ortChangeHandler,n)),n.on("destroy",function(){e(window).off("ortchange",n._ortChangeHandler),r.iScroll.destroy()}),n},_adjustHtml:function(){var t=this,n=t._data,r=t.root().addClass("ui-navigator"),i=r.find("ul"),s=r.find(".ui-navigator-wrapper"),o=i.find("li"),u=[0];return!s.length&&i.wrap('<div class="ui-navigator-wrapper"></div>'),i.find("li").each(function(e){u[e]=e?u[e-1]+this.offsetWidth:u[e]+this.offsetLeft-i[0].offsetLeft+this.offsetWidth}),e.extend(n,{_$navWrapper:r.find(".ui-navigator-wrapper"),_$navScroller:i.width(u[o.length-1]),_$navList:o,_scrollerNum:o.length,_scrollerSumWidth:u,_$fixElemLeft:r.find(".ui-navigator-fixleft"),_$fixElemRight:r.find(".ui-navigator-fixright")}),t},_loadIscroll:function(){var t=this,n=t._data;return n.iScroll=iScroll(n._$navWrapper.get(0),n.iScrollOpts=e.extend({hScroll:!0,vScroll:!1,hScrollbar:!1,vScrollbar:!1},n.iScrollOpts,{onScrollStart:function(e){t.trigger("scrollstart",e)},onScrollMove:function(e){t.trigger("scrollmove",e)},onScrollEnd:function(e){n.isShowShadow&&t._setShadow(),t.trigger("scrollend",e)}})),t},_setShadow:function(){var e=this,t=e._data,n=t._$navWrapper,r={left:"ui-navigator-shadowl",right:"ui-navigator-shadowr",all:"ui-navigator-shadowall"},i=t.iScroll,s=i.x;return s<0?(n.removeClass(r.left+" "+r.right).addClass(r.all),s<=i.maxScrollX&&n.removeClass(r.all+" "+r.right).addClass(r.left)):(n.removeClass(r.all+" "+r.left),i.hScroll?n.addClass(r.right):n.removeClass(r.all+" "+r.left+" "+r.right)),e},_scrollToNext:function(e,t){var n=this,r=n._data,i=r._scrollerSumWidth,s=r.iScroll;return s.scrollTo(t=="last"?s.wrapperW-(i[e+1]||i[i.length-1]):t=="first"?-i[e-2]||0:s.x,0,400),n},_getPos:function(e){var t=this,n=t._data,r=n.iScroll,i=Math.abs(r.x)||0,s=n._scrollerSumWidth,o=n._$navList,u=s[e]-i,a=s[e-1||0]-i,f=(s[e+1]||s[s.length-1])-i,l=r.wrapperW;return u>=l||f>l?"last":u<=o[e].offsetWidth||a<o[e-1].offsetWidth?"first":"middle"},_ortChangeHandler:function(){var e=this,t=e._data,n=t.iScroll;n.refresh(),e._setShadow(),t._$navWrapper.width(n.wrapperW-n.wrapperOffsetLeft)},switchTo:function(e,t,n){var r=this,i=r._data;r.switchToOrg(e,t,n);if(!i._$tabList.eq(e).hasClass("ui-navigator-fix")){var s=i._$fixElemLeft,e=e-(s.length?s.length:0),o=r._getPos(e);t&&i.isShowShadow&&r._setShadow(),i.isScrollToNext&&r._scrollToNext(e,o)}return r}}})})(Zepto);