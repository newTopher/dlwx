define(function(e){(function(e,t,n,r){function N(e,t){if(e===""||e===r)throw new Error("Slide:\u53c2\u6570\u9519\u8bef");var i=n(e),s=this.$ul=i.find("ul"),o=this.$lis=s.find("li"),u=this.size=o.size(),a=this.step=i.width();s.width(a*u),this.$container=i,this.timer=null;var f=function(){};this.option={autoPlay:!0,timeout:4e3,onScrollEnd:f,onScrollStart:f,onDestroy:f},typeof t=="object"&&(this.option=n.extend(this.option,t)),this.index=0,this.distX=0,this.distY=0,this.pointX=0,this.pointY=0,this.isMoving=!1,this.doScrollX=!1,this.loop=!0,this._currentX=0,this.option.autoPlay&&this.autoPlay(),this.bindEvent()}function C(e){return o===""?e:(e=e.charAt(0).toUpperCase()+e.substr(1),o+e)}var i=Math,s=t.createElement("div").style,o=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,r=e.length;for(;n<r;n++){t=e[n]+"ransform";if(t in s)return e[n].substr(0,e[n].length-1)}return!1}(),u=o?"-"+o.toLowerCase()+"-":"",a=C("transform"),f=C("transitionProperty"),l=C("transitionDuration"),c=C("transformOrigin"),h=C("transitionTimingFunction"),p=C("transitionDelay"),d=/android/gi.test(navigator.appVersion),v=/iphone|ipad/gi.test(navigator.appVersion),m=/hp-tablet/gi.test(navigator.appVersion),g=C("perspective")in s,y="ontouchstart"in e&&!m,b=o!==!1,w=C("transition")in s,E=y?"touchstart":"mousedown",S=y?"touchmove":"mousemove",x=y?"touchend":"mouseup",T=y?"touchcancel":"mouseup";N.prototype={destroy:function(e){this._evtCancel(),this.$container[0].removeEventListener(E,this,!0),typeof this.option.onDestroy=="function"&&this.option.onDestroy(e)},autoPlay:function(){var e=this;this.timer=setInterval(function(){e.next()},this.option.timeout)},clearAutoPlay:function(){clearInterval(this.timer)},next:function(){++this.index===this.size&&(this.index=0),this._action()},prev:function(){--this.index<0&&(this.index=this.size-1),this._action()},_action:function(){this.clearAutoPlay(),this._setPos(-this.step*this.index),typeof this.option.onScrollEnd=="function"&&this.option.onScrollEnd.call(this),this.autoPlay()},_setPos:function(e){this._currentX=e,this.$ul[0].style[l]="200ms",this.$ul[0].style[a]="translate("+e+"px,0px)"},_evtStart:function(e){this.isMoving=!1;var t=y?e.touches[0]:e;this.distX=0,this.distY=0,this.DeltaX=0;if(y&&e.touches.length>1)return;this.pointX=t.pageX,this.pointY=t.pageY,typeof this.option.onScrollStart=="function"&&this.option.onScrollStart.call(this,e),this.$container[0].addEventListener(S,this,!1),this.$container[0].addEventListener(x,this,!1),y&&this.$container[0].addEventListener(T,this,!1)},_evtMove:function(e){if(y&&e.touches.length>1){this._evtCancel();return}var t=y?e.touches[0]:e;this.distX=t.pageX-this.pointX,this.distY=t.pageY-this.pointY;if(!this.isMoving)this.isMoving=!0,this.doScrollX=Math.abs(this.distX)>Math.abs(this.distY),this.doScrollX&&e.preventDefault();else if(this.doScrollX){var n=0;if(this.index===0&&this.distX>0||this.index===this.size-1&&this.distX<0)return null;n=parseInt(this._currentX)+parseInt(this.distX),this.$ul[0].style[a]="translate("+n+"px,0px)",e.preventDefault()}},_evtEnd:function(e){this._evtCancel();if(!this.isMoving)return;this.isMoving&&this.doScrollX&&(this.distX>=10?this.index!==0&&this.prev():this.distX<=-10?this.loop?this.next():this._data.index!==this._size-1&&this.next():this._action())},_evtCancel:function(){this.$container[0].removeEventListener(S,this,!1),this.$container[0].removeEventListener(x,this,!1),y&&this.$container[0].removeEventListener(T,this,!1)},bindEvent:function(){this.$container[0].addEventListener(E,this,!0)},handleEvent:function(e){var t=this;switch(e.type){case E:if(!y&&e.button!==0)return;t._evtStart(e);break;case S:t._evtMove(e);break;case x:case T:t._evtEnd(e)}}},s=null,e.Slide=N})(window,document,$)});